# -*- coding:utf-8 -*-

import ssl
import requests
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

ssl._create_default_https_context = ssl._create_unverified_context

def verify(protocol,ip,port):
    url = protocol + '://' + ip + ':' + str(port)
    print('testing if phpmyadmin ‘$GLOBALS’ array unauth access vul(cve-2013-3241)')
    path = ['/phpmyadmin/', '/phpMyAdmin/phpMyAdmin/', '']
    try:
        for i in path:
            r = requests.get(url, verify=False , timeout = 5)
            if r.status_code == 200:
                if 'pma_absolute_uri' in r.text and 'pma_password' not in r.text:
                    msg = 'There is phpmyadmin ‘$GLOBALS’ array unauth access vul(cve-2013-3241) on url: ' + url + ' .'
                    number = 'v126'
                    print(msg)
                    return True, url, number, msg
                else:
                    pass
            pass
    except Exception as e:
        print(str(e))
    msg = 'There is no phpmyadmin ‘$GLOBALS’ array unauth access vul(cve-2013-3241).'
    number = 'v0'
    return False, url, number, msg